I"õ@<h2 id="tensorflow">Tensorflow</h2>

<p>ì´ë²ˆì‹œê°„ì—ëŠ” <code class="language-plaintext highlighter-rouge">Tensorflow</code>ë¥¼ ì´ìš©í•´ì„œ Linear Regressionì„ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<p>ë¨¼ì € Tensorflowë¥¼ ì„¤ì¹˜í•˜ê³  ì‹œì‘í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. TensorflowëŠ” ë²„ì „ì´ 1.xx ë²„ì „ê³¼ 2.xx ë²„ì „ì´ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆì‹œê°„ì—ëŠ” 1.15ë²„ì „ì„ ì„¤ì¹˜í•˜ì—¬ ì‚¬ìš©í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span><span class="w"> </span><span class="nf">pip</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">tensorflow</span><span class="o">==</span><span class="mf">1.15</span><span class="w">
</span></code></pre></div></div>

<p>ì„¤ì¹˜ë¥¼ í•˜ì˜€ìœ¼ë‹ˆ â€˜Hello Worldâ€™ë¥¼ ì¶œë ¥í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="k">print</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">__version__</span><span class="p">)</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">constant</span><span class="p">(</span><span class="s">'Hello World'</span><span class="p">)</span>

<span class="c1"># ìš°ë¦¬ê°€ ë§Œë“  ê·¸ë˜í”„ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ Sessionì´ í•„ìš”!
</span><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>

<span class="c1"># runner ì¸ Session ì´ ìƒì„±ë˜ì—ˆìœ¼ë‹ˆ ì´ê±¸ ì´ìš©í•´ì„œ nodeë¥¼ ì‹¤í–‰í•´ ë³´ì•„ìš”!
</span><span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">node</span><span class="p">))</span> <span class="c1"># b'Hello World' bëŠ” ë°”ì´íŠ¸
</span><span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">node</span><span class="p">).</span><span class="n">decode</span><span class="p">())</span>  <span class="c1">#Hello World'
</span></code></pre></div></div>

<p>ì´ë²ˆì—ëŠ” ë§ì…ˆì„ ìˆ˜í–‰í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># placeholderë¥¼ ì´ìš©
# 2ê°œì˜ ìˆ˜ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ì„œ ë§ì…ˆì—°ì‚°ì„ ìˆ˜í–‰
</span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="n">node1</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span> <span class="c1"># scalar í˜•íƒœì˜ ê°’ 1ê°œë¥¼ ì‹¤ìˆ˜ë¡œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆëŠ” Placeholder
</span><span class="n">node2</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span> <span class="c1"># scalar í˜•íƒœì˜ ê°’ 1ê°œë¥¼ ì‹¤ìˆ˜ë¡œ ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆëŠ” Placeholder
</span><span class="n">node3</span> <span class="o">=</span> <span class="n">node1</span> <span class="o">+</span> <span class="n">node2</span>

<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">node3</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">node1</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="n">node2</span><span class="p">:</span><span class="mi">20</span><span class="p">})</span>
</code></pre></div></div>

<p>ê°„ë‹¨í•œ ì˜ˆì œë¥¼ í†µí•´ì„œ ì˜ˆì¸¡ëª¨ë¸ì„ ë§Œë“¤ì–´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

<span class="c1"># 1. Raw Data Loading
# 2. Data Preprocessing(ë°ì´í„° ì „ì²˜ë¦¬)
# 3. Training data set
</span><span class="n">x_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">23</span><span class="p">]</span>

<span class="c1"># 4. Weight &amp; bias ì •ì˜
</span><span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">name</span> <span class="o">=</span> <span class="s">'weight'</span><span class="p">)</span> <span class="c1"># W = np.random.rand(1,1)
</span><span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">name</span> <span class="o">=</span> <span class="s">'bias'</span><span class="p">)</span> <span class="c1"># b = np.random.rand(1)
</span>
<span class="c1"># 5. hypothesis, simple Linear Regression Model
</span><span class="n">H</span> <span class="o">=</span> <span class="n">W</span> <span class="o">*</span> <span class="n">x_data</span> <span class="o">+</span> <span class="n">b</span>

<span class="c1"># 6. Loss function
</span><span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">square</span><span class="p">(</span><span class="n">t_data</span><span class="o">-</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="c1">#7. train node ìƒì„±
</span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">train</span><span class="p">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">optimizer</span><span class="p">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>

<span class="c1"># 8. ì‹¤í–‰ì¤€ë¹„ ë° ì´ˆê¸°í™”ì‘ì—…
</span><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
<span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">global_variables_initializer</span><span class="p">())</span> <span class="c1"># ì´ˆê¸°í™” ì‘ì—…
</span>
<span class="c1"># 9. ë°˜ë³µí•´ì„œ í•™ìŠµì„ ì§„í–‰!!
</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30000</span><span class="p">):</span>
    <span class="n">_</span><span class="p">,</span><span class="n">W_val</span><span class="p">,</span> <span class="n">b_val</span> <span class="o">=</span> <span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="n">train</span><span class="p">,</span><span class="n">W</span><span class="p">,</span><span class="n">b</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">3000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'W:{}, b:{}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">W_val</span><span class="p">,</span> <span class="n">b_val</span><span class="p">))</span>
        
<span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">H</span><span class="p">))</span> <span class="c1"># [ 6.9997516 10.999857  12.999908  17.000013  23.000172 ]
</span>
<span class="c1"># 10. predict!!
</span><span class="k">print</span><span class="p">(</span><span class="n">sess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">X</span><span class="p">:[</span><span class="mi">6</span><span class="p">]}))</span> <span class="c1"># [13.111737]
</span></code></pre></div></div>

<h3 id="logistic-regression">Logistic Regression</h3>

<p>ì´ì „ê¹Œì§€ ë°°ì› ë˜ Linear Regressionê³¼ ë”ë¶ˆì–´ Logistic Regressionì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. Logistic Regressionì€ 0~1ì‚¬ì´ì˜ ê°’ì„ ê°€ì§€ëŠ” í™•ë¥ ë¡œ í‘œí˜„í•˜ê¸° ìœ„í•˜ì—¬ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>

<p align="center"><img src="../../assets/image/logistic_regression_01.png" alt="Linear Regression vs Logistic Regression" style="zoom=100%;" /></p>

<p align="center"><img src="../../assets/image/images-1460375.png" alt="Logistic Regression" /></p>

<p>ê°„ë‹¨í•œ ì˜ˆì‹œë¥¼ í†µí•´ì„œ Logistic  Regressionì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<p>ê³µë¶€ì‹œê°„ì— ë”°ë¥¸ ì‹œí—˜í•©ê²©ì—¬ë¶€ì— ëŒ€í•œ ë°ì´í„°ë¥¼ Linear Regressionìœ¼ë¡œ ë¶„ì„í•˜ê³  í•©ê²©ì—¬ë¶€ë¥¼ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>

<span class="c1"># Training Data Set
</span><span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span> <span class="c1"># ê³µë¶€ì‹œê°„
</span><span class="n">t_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># ì‹œí—˜í•©ê²©ì—¬ë¶€(0:Fail, 1:Pass)
</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="p">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
         <span class="n">t_data</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">intercept_</span><span class="p">)</span> <span class="c1"># [[0.03500583]] [0.17327888]
</span><span class="n">model</span><span class="p">.</span><span class="n">coef_</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">t_data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">x_data</span> <span class="o">*</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">.</span><span class="n">ravel</span><span class="p">()</span> <span class="o">+</span> <span class="n">model</span><span class="p">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
</code></pre></div></div>

<p align="center"><img src="../../assets/image/image-20200930192313060.png" alt="image-20200930192313060" style="zoom:50%;" /></p>

<p>í•˜ê¸° ê·¸ë˜í”„ë¥¼ ë³´ë©´ ì‹¤ë°ì´í„°ì—ì„œëŠ” 8ì‹œê°„ ì´ìƒ ê³µë¶€ë¥¼ í•œë‹¤ë©´ ì¶©ë¶„íˆ í•©ê²©ì„ í•  ìˆ˜ ìˆì§€ë§Œ Linear Regressionìœ¼ë¡œ ë¶„ì„ì„ í•œë‹¤ë©´ 24ì‹œê°„ ì •ë„ë¥¼ ê³µë¶€ë¥¼ í•´ì•¼ ì‹œí—˜ì„ í•©ê²©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë•Œë¬¸ì— Logistic Regressionì„ ì‚¬ìš©í•œë‹¤ê³  ë³´ì‹œë©´ ë˜ê² ìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ Logistic Regressionì„ ì´ìš©í•˜ë©´ ì˜ˆì¸¡ì„ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># [-7, -6, -5, ....7]
</span><span class="n">y_data</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

:ET