I"–M<h2 id="simple-linear-regression">Simple Linear Regression</h2>

<p>ì´ë²ˆ ì‹œê°„ì—ëŠ” ì‹¤ì œ ì˜ˆì œë¥¼ ê°€ì§€ê³  Linear Regressionì„ ì´ìš©í•˜ì—¬ ì˜ˆì¸¡ ê°’ì„ ì‚°ì¶œí•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<p>ì˜ˆì œëŠ” í•˜ê¸°í‘œì²˜ëŸ¼ ì˜¨ë„ì™€ ì˜¤ì¡´ëŸ‰ì— ëŒ€í•œ ë°ì´í„°ë¥¼ Training dataë¡œ ì‚¬ìš©í•  ì˜ˆì •ì´ë©° íŒŒì¼ì€ ì¶”ê°€ì ìœ¼ë¡œ ì œê³µí•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right">Â </th>
      <th style="text-align: right">Ozone</th>
      <th style="text-align: right">Solar.R</th>
      <th style="text-align: right">Wind</th>
      <th style="text-align: right">Temp</th>
      <th style="text-align: right">Month</th>
      <th style="text-align: right">Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">0</td>
      <td style="text-align: right">41.0</td>
      <td style="text-align: right">190.0</td>
      <td style="text-align: right">7.4</td>
      <td style="text-align: right">67</td>
      <td style="text-align: right">5</td>
      <td style="text-align: right">1</td>
    </tr>
    <tr>
      <td style="text-align: right">1</td>
      <td style="text-align: right">36.0</td>
      <td style="text-align: right">118.0</td>
      <td style="text-align: right">8.0</td>
      <td style="text-align: right">72</td>
      <td style="text-align: right">5</td>
      <td style="text-align: right">2</td>
    </tr>
    <tr>
      <td style="text-align: right">2</td>
      <td style="text-align: right">12.0</td>
      <td style="text-align: right">149.0</td>
      <td style="text-align: right">12.6</td>
      <td style="text-align: right">74</td>
      <td style="text-align: right">5</td>
      <td style="text-align: right">3</td>
    </tr>
    <tr>
      <td style="text-align: right">3</td>
      <td style="text-align: right">18.0</td>
      <td style="text-align: right">313.0</td>
      <td style="text-align: right">11.5</td>
      <td style="text-align: right">62</td>
      <td style="text-align: right">5</td>
      <td style="text-align: right">4</td>
    </tr>
    <tr>
      <td style="text-align: right">4</td>
      <td style="text-align: right">NaN</td>
      <td style="text-align: right">NaN</td>
      <td style="text-align: right">14.3</td>
      <td style="text-align: right">56</td>
      <td style="text-align: right">5</td>
      <td style="text-align: right">5</td>
    </tr>
    <tr>
      <td style="text-align: right">â€¦</td>
      <td style="text-align: right">â€¦</td>
      <td style="text-align: right">â€¦</td>
      <td style="text-align: right">â€¦</td>
      <td style="text-align: right">â€¦</td>
      <td style="text-align: right">â€¦</td>
      <td style="text-align: right">â€¦</td>
    </tr>
    <tr>
      <td style="text-align: right">148</td>
      <td style="text-align: right">30.0</td>
      <td style="text-align: right">193.0</td>
      <td style="text-align: right">6.9</td>
      <td style="text-align: right">70</td>
      <td style="text-align: right">9</td>
      <td style="text-align: right">26</td>
    </tr>
    <tr>
      <td style="text-align: right">149</td>
      <td style="text-align: right">NaN</td>
      <td style="text-align: right">145.0</td>
      <td style="text-align: right">13.2</td>
      <td style="text-align: right">77</td>
      <td style="text-align: right">9</td>
      <td style="text-align: right">27</td>
    </tr>
    <tr>
      <td style="text-align: right">150</td>
      <td style="text-align: right">14.0</td>
      <td style="text-align: right">191.0</td>
      <td style="text-align: right">14.3</td>
      <td style="text-align: right">75</td>
      <td style="text-align: right">9</td>
      <td style="text-align: right">28</td>
    </tr>
    <tr>
      <td style="text-align: right">151</td>
      <td style="text-align: right">18.0</td>
      <td style="text-align: right">131.0</td>
      <td style="text-align: right">8.0</td>
      <td style="text-align: right">76</td>
      <td style="text-align: right">9</td>
      <td style="text-align: right">29</td>
    </tr>
    <tr>
      <td style="text-align: right">152</td>
      <td style="text-align: right">20.0</td>
      <td style="text-align: right">223.0</td>
      <td style="text-align: right">11.5</td>
      <td style="text-align: right">68</td>
      <td style="text-align: right">9</td>
      <td style="text-align: right">30</td>
    </tr>
  </tbody>
</table>

<p>ì €ë²ˆì‹œê°„ê³¼ ë˜‘ê°™ì€ ì ˆì°¨ë¡œ ì˜ˆì¸¡ëª¨ë¸ì„ ë§Œë“¤ì–´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<blockquote>
  <ol>
    <li>Raw Data Loading</li>
    <li>Data Preprocessing ( ë°ì´í„° ì „ì²˜ë¦¬ )</li>
    <li>Training Data Set</li>
    <li>ì´ˆê¸° W, b ì„¸íŒ…</li>
    <li>Loss function ì •ì˜</li>
    <li>í•™ìŠµ ì˜ˆì¸¡ í•¨ìˆ˜ìƒì„±</li>
    <li>ê¸°íƒ€ í”„ë¡œê·¸ë¨ì—ì‚¬ í•„ìš”í•œ ë³€ìˆ˜ ì •ì˜</li>
    <li>í•™ìŠµì§„í–‰</li>
    <li>ì˜ˆì¸¡ê°’ í™•ì¸</li>
  </ol>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">data.my_library.machine_learning_library</span> <span class="kn">import</span> <span class="n">numerical_derivative</span> <span class="k">as</span> <span class="n">nd</span>

<span class="c1"># 1. Raw Data Loading
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./data/ozone.csv'</span><span class="p">)</span>
<span class="c1"># display(df)
</span>
<span class="c1"># 2. Data Preprocessing(ë°ì´í„° ì „ì²˜ë¦¬)
# - ê²°ì¸¡ì¹˜ ì²˜ë¦¬...
# - ì‚­ì œ, ê°’ì„ ë³€ê²½(í‰ê· , ìµœëŒ€, ìµœì†Œ), ê°’ì„ ì˜ˆì¸¡í•´ì„œ ê°’ì„ ëŒ€ì²´ 
# - ì´ìƒì¹˜ ì²˜ë¦¬(outlier)
# - ì´ìƒì¹˜ë¥¼ ê²€ì¶œí•˜ê³ , ë³€ê²½í•˜ëŠ” ì‘ì—…
# - ë°ì´í„° ì •ê·œí™” ì‘ì—…
# - í•™ìŠµì— í•„ìš”í•œ ì»¬ëŸ¼ì„ ì¶”ì¶œ, ìƒˆë¡œ ìƒì„±.
</span>

<span class="c1"># í•„ìš”í•œ column ë§Œ ì¶”ì¶œ
# ê²°ì¹˜ê°’ì„ ì œê±°!!
</span>

<span class="n">training_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'Temp'</span><span class="p">,</span><span class="s">'Ozone'</span><span class="p">,</span> <span class="p">]]</span>
<span class="c1"># display(training_data)
# print(training_data.shape) #(153, 2)
</span>

<span class="n">training_data</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s">'any'</span><span class="p">)</span>
<span class="c1"># display(training_data)
# print(training_data.shape) #(116, 2)
</span>
<span class="c1"># 3. Training Data Set
</span><span class="n">x_data</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">[</span><span class="s">'Temp'</span><span class="p">].</span><span class="n">values</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">[</span><span class="s">'Ozone'</span><span class="p">].</span><span class="n">values</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 4. Simple Linear Regression
#    y = Wx + b //  W,bë¥¼ ì •ì˜
</span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 5. loss function ì •ì˜
</span><span class="k">def</span> <span class="nf">loss_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">power</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># ìµœì†Œì œê³±ë²•
</span>
<span class="c1"># 6. í•™ìŠµì¢…ë£Œ í›„ ì˜ˆì¸¡í•¨ìˆ˜
</span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">W</span><span class="p">)</span> <span class="o">+</span><span class="n">b</span>

<span class="c1"># 7. ê¸°íƒ€ í”„ë¡œê·¸ë¨ì—ì„œ í•„ìš”í•œ ë³€ìˆ˜ë“¤ì„ ì •ì˜
</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">1e-4</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">loss_func</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">t_data</span><span class="p">)</span>

<span class="c1"># 8. í•™ìŠµì„ ì§„í–‰
</span><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30000</span><span class="p">):</span>
    <span class="n">W</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">nd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">-=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">nd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">step</span> <span class="o">%</span><span class="mi">3000</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="s">'W : {}, b : {}, loss : {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">t_data</span><span class="p">)))</span>
    
<span class="c1"># 9. ê·¸ë˜í”„ë¡œ í™•ì¸
</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">t_data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span><span class="o">+</span><span class="n">b</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="mi">62</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>W : [[0.48898185]], b : [0.1382576], loss : 903.6007199549715
W : [[0.58275697]], b : [-1.13623806], loss : 861.0875644794504
W : [[0.59874403]], b : [-2.39947113], loss : 855.7685424676351
W : [[0.61459263]], b : [-3.65176381], loss : 850.5412536613877
W : [[0.63030397]], b : [-4.89321085], loss : 845.4041160065931
W : [[0.64587924]], b : [-6.12390617], loss : 840.3555747335402
W : [[0.66131962]], b : [-7.34394289], loss : 835.3941018864972
W : [[0.67662628]], b : [-8.55341332], loss : 830.518195861303
W : [[0.69180037]], b : [-9.75240898], loss : 825.7263809507612
W : [[0.70684304]], b : [-10.94102059], loss : 821.0172068981508
</code></pre></div></div>

<p align="center"><img src="../../assets/image/9B0AD36F-4089-4B4A-8079-29B5A4697B8D.png" alt="img" style="zoom:100%;" /></p>

<h3 id="scikit-learn">Scikit-learn</h3>

<p>ì•ì„  ì½”ë“œë¥¼ í†µí•˜ì—¬ ìƒê¸°ì˜ ê·¸ë˜í”„ë¥¼ ì–»ì—ˆìŠµë‹ˆë‹¤. ìœ¡ì•ˆìœ¼ë¡œ íŒë‹¨ì„ í•´ë³´ì•˜ì„ë•Œ y ì ˆí¸ì¸ b ê°’ì´ ì¢€ë” ë‚´ë ¤ì˜¤ê³  ê¸°ìš¸ê¸°ê°’ì¸ W ê°€ ë†’ì€ ê°’ì„ ê°€ì ¸ì•¼ë§Œ í•  ê²ƒ ê°™ì€ë°ìš”. ë¬¼ë¡  ê·¸ë˜í”„ì˜ ì¡°ì •ì´ë‚˜ learning_rateë¥¼ ì¡°ì •í•˜ë©´ì„œ ì›í•˜ëŠ” ê²°ê³¼ì¹˜ë¥¼ ì–»ì„ ìˆ˜ ìˆê² ì§€ë§Œ ì´ë²ˆì‹œê°„ì—ëŠ” <code class="language-plaintext highlighter-rouge">Scikit-learn</code>ì„ í†µí•´ì„œ ì¢€ë” ì‰½ê²Œ ìµœì ì˜ ê·¸ë˜í”„ë¥¼ ì–»ì–´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ í†µí•´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>

<span class="c1"># 1. Raw Data Loading
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./data/ozone.csv'</span><span class="p">)</span>
<span class="c1"># display(df)
</span>
<span class="c1"># 2. Data Preprocessing(ë°ì´í„° ì „ì²˜ë¦¬)
# - ê²°ì¸¡ì¹˜ ì²˜ë¦¬...
# - ì‚­ì œ, ê°’ì„ ë³€ê²½(í‰ê· , ìµœëŒ€, ìµœì†Œ), ê°’ì„ ì˜ˆì¸¡í•´ì„œ ê°’ì„ ëŒ€ì²´ 
# - ì´ìƒì¹˜ ì²˜ë¦¬(outlier)
# - ì´ìƒì¹˜ë¥¼ ê²€ì¶œí•˜ê³ , ë³€ê²½í•˜ëŠ” ì‘ì—…
# - ë°ì´í„° ì •ê·œí™” ì‘ì—…
# - í•™ìŠµì— í•„ìš”í•œ ì»¬ëŸ¼ì„ ì¶”ì¶œ, ìƒˆë¡œ ìƒì„±.
</span>

<span class="c1"># í•„ìš”í•œ column ë§Œ ì¶”ì¶œ
# ê²°ì¹˜ê°’ì„ ì œê±°!!
#
</span>
<span class="n">training_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'Temp'</span><span class="p">,</span><span class="s">'Ozone'</span><span class="p">,</span> <span class="p">]]</span>


<span class="n">training_data</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s">'any'</span><span class="p">)</span>
<span class="c1"># display(training_data)
# print(training_data.shape) #(116, 2)
</span>
<span class="c1"># 3. Training Data Set
</span><span class="n">x_data</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">[</span><span class="s">'Temp'</span><span class="p">].</span><span class="n">values</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="n">training_data</span><span class="p">[</span><span class="s">'Ozone'</span><span class="p">].</span><span class="n">values</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 4. sklearnì„ ì´ìš©í•´ì„œ linear regression model ê°ì²´ë¥¼ ìƒì„±
# ì•„ì§ ì™„ì„±ë˜ì§€ì•Šì€( í•™ìŠµë˜ì§€ ì•Šì€ ëª¨ë¸ì„ ì¼ë‹¨ìƒì„±)
</span><span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="p">.</span><span class="n">LinearRegression</span><span class="p">()</span>

<span class="c1"># 5. Training Data Setì„ ì´ìš©í•´ì„œ í•™ìŠµì„ ì§„í–‰!
</span><span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">t_data</span><span class="p">)</span>

<span class="c1"># 6. Wì™€ b ê°’ì„ ì•Œì•„ë‚´ì•¼ í•´ìš”!
</span><span class="k">print</span><span class="p">(</span><span class="s">'W:{}, b:{}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">intercept_</span><span class="p">))</span> 
<span class="c1"># W:[[2.4287033]], b:[-146.99549097]
</span>

<span class="c1"># 7. ê·¸ë˜í”„ë¡œ í™•ì¸í•´ë³´ì•„ìš”!
</span><span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">t_data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">model</span><span class="p">.</span><span class="n">coef_</span><span class="p">)</span><span class="o">+</span><span class="n">model</span><span class="p">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span> 

<span class="c1"># 8. ì˜ˆì¸¡ì„ í•œë²ˆ í•´ë³´ì•„ìš”!!
</span><span class="n">predict_val</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">62</span><span class="p">]])</span>
<span class="k">print</span><span class="p">(</span><span class="n">predict_val</span><span class="p">)</span> <span class="c1">#[[3.58411393]]
</span></code></pre></div></div>

<p align="center"><img src="../../assets/image/40F5C7F4-8DAD-4080-A76E-4D2BE9519FFA.png" alt="img" style="zoom:100%;" /></p>

<p>SK</p>
:ET